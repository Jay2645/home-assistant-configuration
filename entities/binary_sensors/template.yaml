platform: template
sensors:
  cuties_asleep:
    value_template: >-
      {{ (is_state('media_player.bedroom_speaker', 'playing') or is_state('media_player.bedroom_speaker', 'idle'))
         and states.media_player.bedroom_speaker.attributes.media_title == "Rain sounds" }}
    # 15 second delay to avoid false positives when server restarts
    delay_off:
      seconds: 15
  speakers_playing: 
    value_template: >-
      {{ is_state('media_player.bedroom_speaker', 'playing') 
         or is_state('media_player.office_speaker', 'playing')
         or is_state('media_player.bathroom_speaker', 'playing') }}
  cutie_home:
    value_template: >-
      {{ is_state('person.jay', 'home') 
         or is_state('person.michelle', 'home') }}
  server_up:
    value_template: >-
      {{float(states.sensor.uptime.state) >= 1}}
  tesla_initialized:
    value_template: '{{ float(states.sensor.tesla_model_3_mileage_sensor.state) > 0 }}'
  bedroom_chromecast_on:
    value_template: "{{ is_state_attr('remote.harmony_hub', 'current_activity', 'Watch Chromecast') }}"
  bedroom_videogames_on:
    value_template: "{{ is_state_attr('remote.harmony_hub', 'current_activity', 'Play Videogames') }}"